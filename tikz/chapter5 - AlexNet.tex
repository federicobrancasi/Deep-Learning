\documentclass[border=1mm]{standalone}
% \usepackage[margin=2.5cm]{geometry}

\usepackage{graphicx,tikz,tikz-layers} 
\usetikzlibrary{decorations.markings,calc,positioning,arrows,shapes.geometric,arrows.meta}

\colorlet{myred}{red!80!black}
\colorlet{myblue}{blue!80!black}
\colorlet{mybluee}{myblue!80!black}
\colorlet{mygreen}{green!60!black}
\colorlet{myorange}{orange!70!red!60!black}
\colorlet{mydarkred}{red!20!black}
\colorlet{mydarkblue}{blue!40!black}
\colorlet{mydarkgreen}{green!20!black}


\begin{document}

\resizebox{\textwidth}{!}{
\tikz[font=\small,scale=1, every node/.style={outer sep=0pt, inner sep=0pt, align=center}, w/.style={minimum width=#1},h/.style={minimum height=#1},s/.style={minimum size=#1}, eu/.style={shorten >=#1},ed/.style={shorten <=#1},line join=round]
{
\tikzset{>={Latex[length=2.5mm, width=2.25mm]}}

%-----------------------Cube definition -------------------------------
\def\cube#1#2#3#4#5#6#7{
\begin{scope}[shift={(#1,#2)},scale=1]
    \pgfmathsetmacro{\cubex}{#4}
    \pgfmathsetmacro{\cubey}{#5}
    \pgfmathsetmacro{\cubez}{#6}
    \draw [draw=black, line width=.5pt, every edge/.append style={draw=black,  opacity=.4, densely dotted}, fill=#7, fill opacity=1]
    (\cubex/2,\cubey/2,\cubez/2) coordinate (o) -- ++(-\cubex,0,0) coordinate (a) -- ++(0,-\cubey,0) coordinate (b) edge coordinate [pos=1] (g) ++(0,0,-\cubez)  -- ++(\cubex,0,0) coordinate (c) -- cycle
    (o) -- ++(0,0,-\cubez) coordinate (d) -- ++(0,-\cubey,0) coordinate (e) edge (g) -- (c) -- cycle
    (o) -- (a) -- ++(0,0,-\cubez) coordinate (f) edge (g) -- (d) -- cycle;
    \node[rotate=90, xshift=-2cm, yshift=.165cm] {#3};
\end{scope}
}

\begin{scope}[xscale=-1]

\begin{scope}[xshift=1cm]
\cube{0}{0}{}{.25}{5}{6.5}{white,draw=mydarkblue}
\cube{.5}{1.5}{}{.15}{1.5}{2}{myred!5, draw=myred!50}
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-4.65,1.5);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-.5}{-1.5}{}{.15}{1.5}{2}{myred!5, draw=myred!50}
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-3.6,-1.5);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\end{scope}

\begin{scope}[yshift=1cm]
%------------
\cube{-4.45}{.5}{}{.65}{1}{1.25}{myred!5, draw=myred!50}  
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-2.5,1.5);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-4}{2}{}{1}{4}{5}{none,draw=mydarkblue} 
%------------
\cube{-8}{.85}{}{1.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-3.7,-4.9);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-8}{2.95}{}{1.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-2,-.4);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-8}{2}{}{1.5}{4}{2.5}{none,draw=mydarkblue} 
%------------
\cube{-12.25}{2.1}{}{2.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-1.8,.3);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-12.25}{2}{}{2.5}{2}{2.5}{none,draw=mydarkblue} 
%------------
\cube{-16.75}{1.5}{}{2.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-2.5,.3);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-16.75}{2}{}{2.5}{2}{2.5}{none,draw=mydarkblue} 
%------------
\cube{-20.5}{2}{}{1.5}{2}{2.5}{none,draw=mydarkblue} 
%------------
\node[draw=mydarkblue, w=.5cm, h=3.1cm] (a) at (-23.5,1.9) {};
\node[draw=mydarkblue, w=.5cm, h=3.1cm] (b) at (-25.5,1.9) {};
\node[draw=mydarkblue, w=.5cm, h=2cm] (c) at (-27.5,-1.2) {};
\node[below=2mm of c.south, xshift=-.6cm] {1000};

\draw[mydarkblue, <-] (a.west)--+(1.5,0);
\draw[mydarkblue, ->] (a)--(b);
\draw[mydarkblue, ->] (b) to[bend right=40] node[above=5mm] {dense} (c.north);
\draw[mydarkblue, ->] (a.-60) to[out=180,in=0, looseness=.4] +(-1.5,-5);
\draw[mydarkblue, <-] (b.240) to[out=0,in=180, looseness=.4] +(1.5,-5);
\draw[mydarkblue, <-] (a.240) to[out=0,in=180, looseness=.4] +(1.5,-5.2);
\draw[mydarkblue, ->] ($(a.240)+(1.5,0)$) to[out=180,in=0, looseness=.4] +(-1.5,-5);
\end{scope}


\begin{scope}[yshift=-5cm]
%------------
\cube{-4.45}{2.2}{}{.65}{1}{1.25}{myred!5, draw=myred!50}  
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-2.4,-1);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-4}{2}{}{1}{4}{5}{none,draw=mydarkblue} 
%------------
\cube{-8}{.85}{}{1.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-2.6,-.2);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-8}{2.95}{}{1.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-3.7,4.3);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-8}{2}{}{1.5}{4}{2.5}{none,draw=mydarkblue} 
%------------
\cube{-12.25}{1.6}{}{2.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-2.4,-.5);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-12.25}{2}{}{2.5}{2}{2.5}{none,draw=mydarkblue} 
%------------
\cube{-16.75}{2.1}{}{2.75}{.5}{.5}{myred!5, draw=myred!50} 
\draw[dotted,myred] (a)--coordinate[pos=1] (zz) +(-2.4,-.5);
\draw[dotted,myred] (f)--(zz);
\draw[dotted,myred] (b)--(zz);
\cube{-16.75}{2}{}{2.5}{2}{2.5}{none,draw=mydarkblue} 
%------------
\cube{-20.5}{2}{}{1.5}{2}{2.5}{none,draw=mydarkblue} 
%------------
\node[draw=mydarkblue, w=.5cm, h=3.1cm] (aa) at (-23.5,1.9) {};
\node[draw=mydarkblue, w=.5cm, h=3.1cm] (bb) at (-25.5,1.9) {};

\node[below=2mm of aa.south] (ww) {2048};
\node[below=2mm of bb.south] {2048};

\node[left=0.6cm of ww, align=left] {Max\\Pooling};
\node[left=12.75cm of ww, align=left, yshift=-.5cm] {Max\\Pooling};
\node[left=16.5cm of ww, align=left, yshift=-.75cm] {Max\\Pooling};

\draw[mydarkblue, <-] (aa.west)--node[below=2mm] {dense} +(1.5,0);
\draw[mydarkblue, ->] (aa)--node[below=2mm] {dense} (bb);
\draw[mydarkblue, ->] (bb) to[bend left=40] node[above=5mm] {} +(-2,1.9);
\end{scope}

\end{scope}

% Labels
\node at (-1.5,1) {11};
\node at (-1.75,1.75) {11};
\node at (-.75,-1) {11};
\node at (-.5,-1.9) {11};
\node at (-2,0) {224};
\node at (-1.5,-2.6) {224};
\node[align=left] at (0.95,-3.5) {Stride\\of 4};

\node at (4,4.9) {55};
\node at (4.8,.3) {55};
\node at (4.9,-.2) {48};
\node at (4.8,1) {\footnotesize 5};
\node at (4.25,2.08) {\footnotesize 5};

\node at (7.7,4.9) {27};
\node at (8.3,.3) {128};
\node at (8,1) {27};
\node at (8.6,2.09) {\tiny 3};
\node at (8.8,1.8) {\scriptsize 3};
\node at (8.6,4.2) {\tiny 3};
\node at (8.8,3.9) {\scriptsize 3};

\node at (11.3,4.1) {13};
\node at (12.5,1.3) {192};
\node at (11.7,2) {13};
\node at (13.4,3.34) {\tiny 3};
\node at (13.55,3) {\scriptsize 3};

\node at (15.8,4.1) {13};
\node at (17,1.3) {192};
\node at (16.2,1.8) {13};
\node at (17.8,2.75) {\tiny 3};
\node at (18,2.45) {\scriptsize 3};

\node at (20.1,4.1) {13};
\node at (21,1.3) {128};
\node at (20.5,2) {13};

\begin{scope}[yshift=-6cm]
\node at (4,4.9) {55};
\node at (4.8,.3) {55};
\node at (4.9,-.2) {48};
\node at (4.8,2.7) {\footnotesize 5};
\node at (4.25,3.8) {\footnotesize 5};

\node at (7.7,4.9) {27};
\node at (8.3,.3) {128};
\node at (8,1) {27};
\node at (8.6,2.09) {\tiny 3};
\node at (8.8,1.8) {\scriptsize 3};
\node at (8.6,4.2) {\tiny 3};
\node at (8.8,3.9) {\scriptsize 3};

\node at (11.3,4.1) {13};
\node at (12.5,1.3) {192};
\node at (11.7,2) {13};
\node at (13.4,2.85) {\tiny 3};
\node at (13.55,2.5) {\scriptsize 3};

\node at (15.8,4.1) {13};
\node at (17,1.3) {192};
\node at (16.2,1.8) {13};
\node at (17.8,3.35) {\tiny 3};
\node at (18,3) {\scriptsize 3};

\node at (20.1,4.1) {13};
\node at (21,1.3) {128};
\node at (20.5,2) {13};
\end{scope}
}
}
\end{document}
